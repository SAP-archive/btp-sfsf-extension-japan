sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","./BaseController"],function(e,t,i,n,s,r){"use strict";return r.extend("com.sap.sfsf.comparison.Reshuffle_Comparison_UI.controller.Main",{onInit:function(){this.fragmentDirectory="com.sap.sfsf.comparison.Reshuffle_Comparison_UI.view.fragment.";this.getView().byId("slCaseId").setFilterFunction(function(e,t){return t.getText().match(new RegExp(e,"i"))||t.getKey().match(new RegExp(e,"i"))})},onGroup:function(){this.showDialogFragment(this.getView().getId(),"GroupDialog")},onSort:function(){this.showDialogFragment(this.getView().getId(),"SortDialog")},onSetting:function(){this.showDialogFragment(this.getView().getId(),"SettingDialog")},handleSortDialogConfirm:function(e){var t=this.getView();var i=t.byId("CandidatesTable");var n=e.getParameters();var s=i.getBinding("items");var r=[];var a=n.sortItem.getKey();var o=n.sortDescending;r.push(new sap.ui.model.Sorter(a,o));s.sort(r)},handleGroupDialogConfirm:function(e){var t=this.getView();var i=t.byId("CandidatesTable");var n=e.getParameters();var s=i.getBinding("items"),r,a,o,l=[];if(n.groupItem){r=n.groupItem.getKey();a=n.groupDescending;var o=function(e){var t=e.getProperty(r);return{key:t,text:t}};l.push(new sap.ui.model.Sorter(r,a,o))}s.sort(l)},onCancelSettingDialog:function(e){this.oDataBeforeOpen={};e.getSource().close()},onOKSettingDialog:function(e){var t=this.getView();var i=e.mParameters.payload.columns.selectedItems;var n=i.length;var s=e.mParameters.payload.columns.tableItems;var r=s.length;for(var a of s){var o=a.columnKey;this.getView().byId(o).setVisible(false)}for(var a of i){var o=a.columnKey;this.getView().byId(o).setVisible(true)}e.getSource().close()},onAfterRendering:function(){this._oCompareButton=this.getView().byId("compareBtn")},onToNextPage:function(){this.getOwnerComponent().getRouter().navTo("page2")},onSelection:function(e){var t,i;this.getOwnerComponent().aSelectedItems=e.getSource().getSelectedContextPaths();t=this.getOwnerComponent().aSelectedItems.length;i=t>1;if(i){this.getResourceText("compareBtnName");this._oCompareButton.setText(this.getResourceText("compareBtnName")+" ("+this.getOwnerComponent().aSelectedItems.length+")")}this._oCompareButton.setVisible(i)},handleCaseIdSelectionFinish:function(e){var t=e.getParameter("selectedItems");this.selectedCaseId=[];for(var i=0;i<t.length;i++){this.selectedCaseId.push(t[i].getText())}},onSearch:function(e){var t=this.getView().getModel();var i=t.getData();var n=i.candidates;n=this._searchCaseId(n,this.selectedCaseId);n=this._searchDivision(n,this._getSelectedItemText(this._getSelect("slCandidateDivision")),"C");n=this._searchDepartment(n,this._getSelectedItemText(this._getSelect("slCandidateDepartment")),"C");n=this._searchPosition(n,this._getSelectedItemText(this._getSelect("slCandidatePosition")),"C");n=this._searchDivision(n,this._getSelectedItemText(this._getSelect("slDivision")),"N");n=this._searchDepartment(n,this._getSelectedItemText(this._getSelect("slDepartment")),"N");n=this._searchPosition(n,this._getSelectedItemText(this._getSelect("slPosition")),"N");n=this._searchCandidateId(n,t.getProperty("/candidateId"));n=this._searchCandidateName(n,t.getProperty("/candidateName"));i.list=n;t.setData(i);t.refresh(true);this.getView().setModel(t)},onClear:function(e){var t=this.getView().getModel().getData();t.candidateId="";t.candidateName="";this.getView().byId("slCaseId").removeAllSelectedItems();this._getSelect("slCandidateDivision").setSelectedKey("");this._getSelect("slCandidateDepartment").setSelectedKey("");this._getSelect("slCandidatePosition").setSelectedKey("");this._getSelect("slDivision").setSelectedKey("");this._getSelect("slDepartment").setSelectedKey("");this._getSelect("slPosition").setSelectedKey("");this.getView().getModel().setData(t)},_searchDivision:function(e,t,i){if(t===""){return e}else{return e.filter(function(e,n){if(i==="C"){if(e.candidateDivision===t){return true}else{return false}}else if(i==="N"){if(e.division===t){return true}else{return false}}else{return false}})}},_searchDepartment:function(e,t,i){if(t===""){return e}else{return e.filter(function(e,n){if(i==="C"){if(e.candidateDepartment===t){return true}else{return false}}else if(i==="N"){if(e.department===t){return true}else{return false}}else{return false}})}},_searchPosition:function(e,t,i){if(t===""){return e}else{return e.filter(function(e,n){if(i==="C"){if(e.candidatePosition===t){return true}else{return false}}else if(i==="N"){if(e.position===t){return true}else{return false}}else{return false}})}},_searchCandidateId:function(e,t){if(t===""){return e}else{return e.filter(function(e,i){if(e.candidateID===t){return true}else{return false}})}},_searchCandidateName:function(e,t){if(t===""){return e}else{return e.filter(function(e,i){if(~e.candidateName.indexOf(t)){return true}else{return false}})}},_getSelect:function(e){return this.getView().byId(e)},_getSelectedItemText:function(e){return e.getSelectedItem()?e.getSelectedItem().getKey():""},_searchCaseId:function(e,t){if(t&&t.length>0){return e.filter(function(e,i){if(t.includes(e.caseID)){return true}else{return false}})}else{return e}}})});